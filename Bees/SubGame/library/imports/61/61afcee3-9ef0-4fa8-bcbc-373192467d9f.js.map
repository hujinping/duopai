{"version":3,"sources":["../../../../assets/Script/assets/Script/RankingCell.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class RankingCell extends cc.Component {\r\n\r\n    @property(cc.Sprite)\r\n    sprBg: cc.Sprite = null;\r\n    @property(cc.Sprite)\r\n    sprMedal: cc.Sprite = null;\r\n    @property(cc.Sprite)\r\n    sprHead: cc.Sprite = null;\r\n    @property(cc.Label)\r\n    lbRank: cc.Label = null;\r\n    @property(cc.Label)\r\n    lbName: cc.Label = null;\r\n    @property(cc.Label)\r\n    lbScore: cc.Label = null;\r\n    @property([cc.SpriteFrame])\r\n    medalFrames: cc.SpriteFrame[] = [];\r\n    @property([cc.SpriteFrame])\r\n    bgFrames: cc.SpriteFrame[] = [];\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    setData(rank, data) {\r\n        this.createImage(data.avatarUrl);\r\n        this.lbName.string = this.cutstr(data.nickname, 10);\r\n        this.setMedal(rank);\r\n        //this.setBg(rank);\r\n        if(!data.KVDataList) {\r\n            return;\r\n        }\r\n        let score = data.KVDataList.length != 0 ? data.KVDataList[0].value : 0;\r\n        this.lbScore.string = this.formatNumber(Number(score))+'';\r\n    }\r\n\r\n    setBg(idx) {\r\n        idx = idx % 2;\r\n        this.sprBg.spriteFrame = this.bgFrames[idx];\r\n    }\r\n\r\n    setMedal(idx) {\r\n        if(idx < 3) {\r\n            this.sprMedal.node.active = true;\r\n            this.sprMedal.spriteFrame = this.medalFrames[idx];\r\n            this.lbRank.node.active = false;\r\n        }else{\r\n            this.lbRank.node.active = true;\r\n            this.lbRank.string = idx+1;\r\n            this.sprMedal.node.active = false;\r\n        }\r\n    }\r\n\r\n    createImage(avatarUrl) {\r\n        if (window.wx != undefined) {\r\n            try {\r\n                let image = wx.createImage();\r\n                image.onload = () => {\r\n                    try {\r\n                        let texture = new cc.Texture2D();\r\n                        texture.initWithElement(image);\r\n                        texture.handleLoadedTexture();\r\n                        this.sprHead.spriteFrame = new cc.SpriteFrame(texture);\r\n                    } catch (e) {\r\n                        cc.log(e);\r\n                        this.sprHead.node.active = false;\r\n                    }\r\n                };\r\n                image.src = avatarUrl;\r\n            } catch (e) {\r\n                cc.log(e);\r\n                this.sprHead.node.active = false;\r\n            }\r\n        } else {\r\n            cc.loader.load({\r\n                url: avatarUrl,\r\n                type: 'jpg'\r\n            }, (err, texture) => {\r\n                this.sprHead.spriteFrame = new cc.SpriteFrame(texture);\r\n            });\r\n        }\r\n    }\r\n\r\n    //裁剪字符串，超出指定长度之后显示...(每个中文字符长度为2）\r\n    cutstr(str, len) {\r\n        let str_length = 0;\r\n        let str_len = 0;\r\n        let str_cut = new String();\r\n        str_len = str.length;\r\n        for (var i = 0; i < str_len; i++) {\r\n            let a = str.charAt(i);\r\n            str_length++;\r\n            if (escape(a).length > 4) {\r\n                //中文字符的长度经编码之后大于4 \r\n                str_length++;\r\n            }\r\n            str_cut = str_cut.concat(a);\r\n            if (str_length > len) {\r\n                str_cut = str_cut.concat(\"...\");\r\n                return str_cut;\r\n            }\r\n        }\r\n        // //如果给定字符串小于指定长度，则返回源字符串； \r\n        // if (str_length < len) {\r\n        //     return str;\r\n        // }\r\n        return str;\r\n    }\r\n\r\n    formatNumber(number:number){\r\n        if(number>Math.pow(10,33)){\r\n            return (number/Math.pow(10,33)).toFixed(1)+\"gg\"\r\n        }if(number>Math.pow(10,30)){\r\n            return (number/Math.pow(10,30)).toFixed(1)+\"ff\"\r\n        }else if(number>Math.pow(10,27)){\r\n            return (number/Math.pow(10,27)).toFixed(1)+\"ee\"\r\n        }else if(number>Math.pow(10,24)){\r\n            return (number/Math.pow(10,24)).toFixed(1)+\"dd\"\r\n        }else if(number>Math.pow(10,21)){\r\n            return (number/Math.pow(10,21)).toFixed(1)+\"cc\"\r\n        }else if(number>Math.pow(10,18)){\r\n            return (number/Math.pow(10,18)).toFixed(1)+\"bb\"\r\n        }else if(number>Math.pow(10,15)){\r\n            return (number/Math.pow(10,15)).toFixed(1)+\"aa\"\r\n        }else if(number>Math.pow(10,12)){\r\n            return (number/Math.pow(10,12)).toFixed(1)+\"T\"\r\n        }else if(number>Math.pow(10,9)){//十亿\r\n            return (number/Math.pow(10,9)).toFixed(1)+\"B\"\r\n        }else if(number>Math.pow(10,6)){//百万\r\n            return (number/Math.pow(10,6)).toFixed(1)+\"M\"\r\n        }else if(number>Math.pow(10,3)){//千\r\n            return (number/Math.pow(10,3)).toFixed(1)+\"K\"\r\n        }\r\n        return number;\r\n    }\r\n\r\n    // start () {\r\n\r\n    // }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}