{"version":3,"sources":["ViewManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Common","sourcesContent":["/**\r\n * 弹窗管理\r\n */\r\nimport PopupView from \"../ui/view/PopupView\";\r\nimport PromptDialog from \"../ui/view/PromptDialog\";\r\nimport BaseDialog from \"../ui/view/BaseDialog\";\r\nimport ToastView from \"../UI/view/ToastView\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ViewManager extends cc.Component {\r\n    private static mViewManager: ViewManager;\r\n\r\n    private static LocalZOrder = {\r\n        PromptDialog: 1000,\r\n        Loading: 1001,\r\n        Toast: 1002\r\n    }\r\n\r\n    static readonly View = {\r\n        PromptDialog: \"PromptDialog\",//提示弹窗\r\n        ToastView: \"ToastView\",//Toast提示\r\n    }\r\n\r\n    @property(cc.Prefab)\r\n    popupView: cc.Prefab = null;//基础弹出界面\r\n\r\n    @property(cc.Prefab)\r\n    promptDialog: cc.Prefab = null;//提示弹窗\r\n\r\n    @property(cc.Prefab)\r\n    toastView: cc.Prefab = null;//Toast提示\r\n\r\n    private popupViewList: Array<PopupView> = new Array<PopupView>();//弹出的窗口列表\r\n    private popupViewMap = {};//弹出窗口集合\r\n\r\n    onLoad() {\r\n        ViewManager.mViewManager = this;\r\n        cc.game.addPersistRootNode(this.node);\r\n\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN as any, this.onKeyDown, this);\r\n    }\r\n\r\n    onDestroy() {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN as any, this.onKeyDown, this);\r\n    }\r\n\r\n    //响应系统键盘事件\r\n    private onKeyDown(event) {\r\n        if (event.keyCode == cc.KEY.back) {//响应返回键\r\n            while (this.popupViewList.length > 0) {\r\n                let popupView: PopupView = this.popupViewList.pop();\r\n                this.removeFromMap(popupView);\r\n                if (cc.isValid(popupView)) {\r\n                    popupView.dismiss();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //弹出界面销毁回调\r\n    private onPopupDestroy(popupView: PopupView) {\r\n        this.removeFromMap(popupView);\r\n        this.removeFromArray(popupView);\r\n        \r\n    }\r\n\r\n    private show(popupView: PopupView, parent = null as cc.Node) {\r\n        if (!cc.isValid(popupView)) {\r\n            return;\r\n        }\r\n        if (popupView.closeOnKeyBack) {\r\n            this.popupViewList.push(popupView);\r\n        }\r\n        if (ViewManager.getPopupView(popupView.name) != popupView) {\r\n            ViewManager.dismiss(popupView.name);\r\n        }\r\n        if (popupView.name) {\r\n            this.popupViewMap[popupView.name] = popupView;\r\n        }\r\n        popupView.setOnDestroyCallback(this.onPopupDestroy.bind(this));\r\n        popupView.show(parent || ViewManager.getRoot());\r\n    }\r\n\r\n    private removeFromMap(popupView: PopupView) {\r\n        if (!popupView) {\r\n            return;\r\n        }\r\n        if (popupView.name) {\r\n            this.popupViewMap[popupView.name] = null;\r\n        }\r\n    }\r\n\r\n    private removeFromArray(popupView: PopupView) {\r\n        if (!popupView) {\r\n            return;\r\n        }\r\n        let position = this.popupViewList.indexOf(popupView);\r\n        if (position >= 0) {\r\n            this.popupViewList.splice(position, 1);\r\n        }\r\n    }\r\n\r\n    private static checkValid(): boolean {\r\n        return !!ViewManager.mViewManager;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * 显示弹出界面\r\n     */\r\n    static show({\r\n        node = null as cc.Node,//需要显示的界面\r\n        name = null as string,//界面名称，标识界面的唯一性\r\n        parent = null as cc.Node,//弹出父节点\r\n        localZOrder = 0,//节点局部 Z 轴顺序\r\n        data = {} as any,//传入数据\r\n        closeOnTouchOutside = false,//是否点击外面空白区域关闭界面\r\n        closeOnKeyBack = false,//是否响应返回键关闭界面\r\n        mask = true,//是否有蒙层覆盖\r\n        maskOpacity = 200,//蒙层不透明度\r\n        transitionShow = false,//是否显示打开过渡动画\r\n        transitionDismiss = true,//是否显示关闭过渡动画\r\n        showAction = null as cc.FiniteTimeAction,\r\n        showActionTarget = null as cc.Node,\r\n        dismissAction = null as cc.FiniteTimeAction,\r\n        dismissActionTarget = null as cc.Node\r\n    }): PopupView {\r\n        if (!cc.isValid(node)) {\r\n            return;\r\n        }\r\n        if (!ViewManager.checkValid() || !cc.isValid(ViewManager.mViewManager.popupView)) {\r\n            return;\r\n        }\r\n        let popupView: PopupView = node.getComponent(PopupView);\r\n        if (!popupView) {\r\n            let popupNode = cc.instantiate(ViewManager.mViewManager.popupView);\r\n            popupView = popupNode.getComponent(PopupView);\r\n            popupView.contentNode = node;\r\n            popupView.contentNode.parent = popupView.node;\r\n        } else {\r\n            popupView.contentNode = popupView.contentNode\r\n                || popupView.node.getChildByName(\"ContentNode\")\r\n                || popupView.node;\r\n        }\r\n        ViewManager.showPopup({\r\n            popupView,\r\n            name,\r\n            parent,\r\n            localZOrder,\r\n            closeOnTouchOutside,\r\n            closeOnKeyBack,\r\n            mask,\r\n            maskOpacity,\r\n            transitionShow,\r\n            transitionDismiss,\r\n            showAction,\r\n            showActionTarget,\r\n            dismissAction,\r\n            dismissActionTarget\r\n        });\r\n        return popupView;\r\n    }\r\n\r\n    static showPopup({\r\n        popupView = null as PopupView,\r\n        name = null as string,//界面名称，标识界面的唯一性\r\n        parent = null as cc.Node,//弹出父节点\r\n        localZOrder = 0,//节点局部 Z 轴顺序\r\n        closeOnTouchOutside = false,//是否点击外面空白区域关闭界面\r\n        closeOnKeyBack = false,//是否响应返回键关闭界面\r\n        mask = true,//是否有蒙层覆盖\r\n        maskOpacity = 200,//蒙层不透明度\r\n        transitionShow = false,//是否显示打开过渡动画\r\n        transitionDismiss = true,//是否显示关闭过渡动画\r\n        showAction = null as cc.FiniteTimeAction,\r\n        showActionTarget = null as cc.Node,\r\n        dismissAction = null as cc.FiniteTimeAction,\r\n        dismissActionTarget = null as cc.Node\r\n    }) {\r\n        if (!ViewManager.checkValid() || !cc.isValid(popupView)) {\r\n            return;\r\n        }\r\n\r\n        //蒙层\r\n        if (closeOnTouchOutside) {\r\n            mask = true;\r\n        }\r\n        popupView.setMask(mask, maskOpacity);\r\n\r\n        //打开动画\r\n        showActionTarget = showActionTarget || popupView.contentNode;\r\n        if (transitionShow && cc.isValid(showActionTarget)) {\r\n            showAction = showAction || cc.sequence(\r\n                cc.callFunc(() => { showActionTarget.scale = 0; }),\r\n                cc.scaleTo(0.1, 1, 1).easing(cc.easeOut(3.0))\r\n            );\r\n        }\r\n        popupView.setShowAction(showAction, showActionTarget);\r\n\r\n        //关闭动画\r\n        dismissActionTarget = dismissActionTarget || popupView.contentNode;\r\n        if (transitionDismiss) {\r\n            dismissAction = dismissAction || null;\r\n        }\r\n        popupView.setDismissAction(dismissAction, dismissActionTarget);\r\n\r\n        popupView.closeOnTouchOutside = closeOnTouchOutside;\r\n        popupView.closeOnKeyBack = closeOnKeyBack;\r\n        popupView.name = name || popupView.name;\r\n        popupView.localZOrder = localZOrder || 0;\r\n\r\n        ViewManager.mViewManager.show(popupView, parent);\r\n    }\r\n\r\n    private static dismissPopup(popupView: PopupView) {\r\n        if (!popupView) {\r\n            return;\r\n        }\r\n        if (cc.isValid(popupView)) {\r\n            popupView.dismiss();\r\n        }\r\n        if (!ViewManager.checkValid()) {\r\n            return;\r\n        }\r\n        ViewManager.mViewManager.removeFromMap(popupView);\r\n        ViewManager.mViewManager.removeFromArray(popupView);\r\n    }\r\n\r\n    static dismiss(name: string) {\r\n        if (!name) {\r\n            return;\r\n        }\r\n        if (!ViewManager.checkValid()) {\r\n            return;\r\n        }\r\n        let popupView = ViewManager.mViewManager.popupViewMap[name];\r\n        if (cc.isValid(popupView)) {\r\n            popupView.dismiss();\r\n        }\r\n        ViewManager.mViewManager.popupViewMap[name] = null;\r\n        ViewManager.mViewManager.removeFromMap(popupView);\r\n        ViewManager.mViewManager.removeFromArray(popupView);\r\n    }\r\n\r\n    static isShow(name: string): boolean {\r\n        if (!name) {\r\n            return false;\r\n        }\r\n        if (!ViewManager.checkValid()) {\r\n            return false;\r\n        }\r\n        return cc.isValid(ViewManager.mViewManager.popupViewMap[name]);\r\n    }\r\n\r\n    /**\r\n     * 获取当前正在显示的弹出界面\r\n     * \r\n     * @param name 弹出界面名称\r\n     */\r\n    public static getPopupView(name: string) {\r\n        if (!name) {\r\n            return null;\r\n        }\r\n        if (!ViewManager.checkValid()) {\r\n            return null;\r\n        }\r\n        if (cc.isValid(ViewManager.mViewManager.popupViewMap[name])) {\r\n            return ViewManager.mViewManager.popupViewMap[name];\r\n        } else if (ViewManager.mViewManager.popupViewMap[name]) {\r\n            ViewManager.mViewManager.popupViewMap[name] = null;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    \r\n\r\n    static createDialog<T extends BaseDialog>(name: string) {\r\n        if (!ViewManager.checkValid()) {\r\n            return;\r\n        }\r\n        let node;\r\n    }\r\n\r\n    \r\n\r\n    /**\r\n     * 显示通用提示弹窗\r\n     * \r\n     * @param data \r\n     */\r\n    static showPromptDialog(data: {\r\n        message: string,//提示内容\r\n        name?: string,//弹窗名字标识\r\n        leftText?: string,//左边文字\r\n        rightText?: string,//右边文字\r\n        sureButtonClick?: Function,//左边按钮点击事件\r\n        cancelButtonClick?: Function,//右边按钮点击事件\r\n        singleButton?: boolean//是否只显示确认按钮\r\n    }) {\r\n        if (!ViewManager.checkValid()) {\r\n            return;\r\n        }\r\n        let prompt = cc.instantiate(ViewManager.mViewManager.promptDialog);\r\n        let promptDialog = prompt.getComponent(PromptDialog);\r\n        promptDialog.setData(data);\r\n        ViewManager.show({\r\n            node: prompt,\r\n            name: data.name || ViewManager.View.PromptDialog,\r\n            localZOrder: ViewManager.LocalZOrder.PromptDialog,\r\n            mask: true,\r\n            maskOpacity: 200,\r\n            transitionShow: true\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 浮层文字提示\r\n     * \r\n     * @param message 提示内容\r\n     */\r\n    static toast(message: string, textColor: cc.Color = cc.color(255,255,255), fontSize = 0) {\r\n        if (!ViewManager.checkValid()) {\r\n            return;\r\n        }\r\n        let old = ViewManager.getPopupView(ViewManager.View.ToastView);\r\n        let toast;\r\n        let toastView: ToastView;\r\n        if (old instanceof ToastView) {\r\n            toast = old.node;\r\n            toastView = old;\r\n        } else {\r\n            toast = cc.instantiate(ViewManager.mViewManager.toastView);\r\n            toastView = toast.getComponent(ToastView);\r\n        }\r\n        toastView.setMessage(message);\r\n        toastView.setFontSize(fontSize);\r\n        toastView.setTextColor(textColor);\r\n        ViewManager.show({\r\n            node: toast,\r\n            name: ViewManager.View.ToastView,\r\n            localZOrder: ViewManager.LocalZOrder.Toast,\r\n            mask: false,\r\n            transitionDismiss: false\r\n        });\r\n    }\r\n\r\n    static getRoot() {\r\n        return cc.director.getScene().getChildByName(\"Canvas\");\r\n    }\r\n\r\n}\r\n"]}