{"version":3,"sources":["offlineIncome.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/Script/UI/component","sourcesContent":["import Util from \"../../Common/Util\";\nimport GameCtr from \"../../Controller/GameCtr\";\nimport AudioManager from \"../../Common/AudioManager\";\nimport WXCtr from \"../../Controller/WXCtr\";\nimport HttpCtr from \"../../Controller/HttpCtr\";\nconst {ccclass, property} = cc._decorator;\n@ccclass\nexport default class NewClass extends cc.Component {\n    _btn_get=null;\n    _btn_close=null;\n    _lb_bonus=null;\n    _offlineIncome=0;\n    onLoad(){\n        this._btn_get=this.node.getChildByName(\"btn_get\");\n        this._btn_close=this.node.getChildByName(\"btn_close\")\n        this._lb_bonus=this.node.getChildByName(\"lb_bonus\");\n        this._lb_bonus.getComponent(cc.Label).string=\"\"\n        this.initBtn(this._btn_get);\n        this.initBtn(this._btn_close);\n        this._btn_get.active=GameCtr.isAudited;\n    }\n\n\n    init(offlineTime){\n        let combsUnlock=JSON.parse(GameCtr.getInstance().getCombsUnlock());\n        let manufactures_speed=GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].perBonus/\n                                (GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].productTime+\n                                    GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].transferTime);\n        let combs_speed=0;\n        for(let i=0;i<combsUnlock.length;i++){\n            combs_speed+=(GameCtr.combConfig[i].initialIncome+GameCtr.combConfig[i].incomeMatrix*(combsUnlock[i].level-1)*combsUnlock[i].level)/(GameCtr.combConfig[i].baseSpeed*2)\n        }\n        let finalSpeed =combs_speed>=manufactures_speed?manufactures_speed:combs_speed;\n        this._offlineIncome =offlineTime*finalSpeed;\n        this._lb_bonus.getComponent(cc.Label).string=\"$\"+Util.formatNumber(Math.floor(this._offlineIncome));\n    }\n\n    initBtn(btn){\n        btn.on(cc.Node.EventType.TOUCH_END,(e)=>{\n            if(e.target.getName()==\"btn_get\"){\n                let callFunc=()=>{\n                    GameCtr.money+=Math.floor(2*this._offlineIncome);\n                    GameCtr.rich+=Math.floor(2*this._offlineIncome);\n                    GameCtr.getInstance().getGame().setMaskVisit(false);\n                    GameCtr.getInstance().getLevel().setMoney();\n                    this.node.destroy();\n                }\n                if(GameCtr.vedioTimes<=0){\n                    WXCtr.share({callback:callFunc});\n                    HttpCtr.openClick(GameCtr.clickType.offLineShare);\n                }else{\n                    WXCtr.showVideoAd(callFunc.bind(this));\n                    HttpCtr.openClick(GameCtr.clickType.offLineVedio);\n                }\n                \n            }else if(e.target.getName()==\"btn_close\"){\n                GameCtr.money+=Math.floor(this._offlineIncome);\n                GameCtr.rich+=Math.floor(this._offlineIncome);\n                GameCtr.getInstance().getGame().setMaskVisit(false);\n                GameCtr.getInstance().getLevel().setMoney();\n                this.node.destroy();\n            }\n            AudioManager.getInstance().playSound(\"audio/btnClose\");\n        })\n    }\n}\n"]}