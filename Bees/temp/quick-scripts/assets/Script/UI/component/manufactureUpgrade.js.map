{"version":3,"sources":["manufactureUpgrade.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/Script/UI/component","sourcesContent":["\r\nconst {ccclass, property} = cc._decorator;\r\nimport AudioManager from \"../../Common/AudioManager\";\r\nimport GameCtr from \"../../Controller/GameCtr\";\r\nimport Util from \"../../Common/Util\";\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n    lb_des=null;\r\n    _btn_close=null;\r\n    _btn_upgrade=null;\r\n    _lb_cost=null;\r\n\r\n    onLoad(){\r\n        this.initNode()\r\n    }\r\n\r\n    initNode(){\r\n        this.lb_des=this.node.getChildByName(\"lb_des\");\r\n        this._btn_close=this.node.getChildByName(\"btn_close\");\r\n        this.lb_des.getComponent(cc.Label).string=GameCtr.ManufactureLevel+1;\r\n        if(this.isMaxLevel()){\r\n            this.lb_des.getComponent(cc.Label).string=GameCtr.ManufactureLevel; \r\n        }\r\n        \r\n        this.showHoneyProfit();\r\n        this.showSpeed();\r\n        this.showCapacity();\r\n        this.showUpgrade();\r\n\r\n        this.initBtnEvent(this._btn_close); \r\n        this.initBtnEvent(this._btn_upgrade);\r\n        this.showBtn();\r\n    }\r\n\r\n    showHoneyProfit(){\r\n        let honeyProfit=this.node.getChildByName(\"honeyProfit\")\r\n        let lb_value=honeyProfit.getChildByName(\"lb_value\");\r\n        let lb_add=honeyProfit.getChildByName(\"lb_add\");\r\n        \r\n\r\n        lb_value.getComponent(cc.Label).string=\"$\"+Util.formatNumber(Math.ceil(GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].perBonus-0));\r\n        lb_add.getComponent(cc.Label).string=\"+$\"+Util.formatNumber(Math.ceil(GameCtr.manufactureConfig[GameCtr.ManufactureLevel].perBonus-GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].perBonus));\r\n    }\r\n\r\n    showSpeed(){\r\n        let speed=this.node.getChildByName(\"speed\")\r\n        let lb_value=speed.getChildByName(\"lb_value\");\r\n        let lb_add=speed.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=\"\"+Math.ceil(GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].showSpeed*100)+\"%\";\r\n        lb_add.getComponent(cc.Label).string=\"+1%\";//\"+\"+Math.ceil((GameCtr.manufactureConfig[GameCtr.ManufactureLevel].showSpeed-GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].showSpeed)*100)+\"%\";\r\n    }\r\n\r\n    showCapacity(){\r\n        let capacity=this.node.getChildByName(\"capacity\")\r\n        let lb_value=capacity.getChildByName(\"lb_value\");\r\n        let lb_add=capacity.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=Util.formatNumber(Math.ceil(GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].perBonus))+\"\"\r\n        lb_add.getComponent(cc.Label).string=\"+\"+Util.formatNumber(Math.ceil(GameCtr.manufactureConfig[GameCtr.ManufactureLevel].perBonus-GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].perBonus));\r\n    }\r\n\r\n    showUpgrade(){\r\n        let upgrade=this.node.getChildByName(\"upgrade\");\r\n        this._btn_upgrade=upgrade.getChildByName(\"btn_upgrade\");\r\n        this._lb_cost=this._btn_upgrade.getChildByName(\"lb_cost\");\r\n        if(this.isMaxLevel()){return}\r\n        this.lb_des.getComponent(cc.Label).string=GameCtr.ManufactureLevel+1;\r\n        this._lb_cost.getComponent(cc.Label).string=\"$\"+Util.formatNumber(GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].cost);\r\n    }\r\n\r\n    initBtnEvent(btn){\r\n        btn.on(cc.Node.EventType.TOUCH_END,(e)=>{\r\n            if(e.target.getName()==\"btn_close\"){\r\n                this.node.destroy();\r\n                GameCtr.getInstance().getGame().setMaskVisit(false);\r\n                GameCtr.getInstance().getGame().clearManufactureUpgrade();\r\n                AudioManager.getInstance().playSound(\"audio/btnClose\");\r\n            }else if(e.target.getName()==\"btn_upgrade\"){\r\n\r\n                if(GameCtr.ManufactureLevel<GameCtr.maxManufactureLevel&&GameCtr.money<GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].cost){\r\n                    GameCtr.getInstance().getGame().showGoldNotEnough();\r\n                    return;\r\n                }\r\n\r\n                if(!this._btn_upgrade.getComponent(cc.Button).interactable){return;}\r\n\r\n                GameCtr.getInstance().getManufacture().upgrade();\r\n                AudioManager.getInstance().playSound(\"audio/levelup\"); \r\n                this.showBtn();\r\n                if(this.isMaxLevel()){return}\r\n\r\n                this.lb_des.getComponent(cc.Label).string=GameCtr.ManufactureLevel+1;\r\n                this.showHoneyProfit();\r\n                this.showSpeed();\r\n                this.showCapacity();\r\n                this.showUpgrade();\r\n                \r\n            }\r\n        })\r\n    }\r\n\r\n    showBtn(){\r\n        if(GameCtr.money>=GameCtr.manufactureConfig[GameCtr.ManufactureLevel-1].cost){\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=true;\r\n        }else{\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=false;\r\n        }\r\n        if(GameCtr.ManufactureLevel>=GameCtr.maxManufactureLevel){\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=false;\r\n            let lb_cost=this._btn_upgrade.getChildByName(\"lb_cost\");\r\n            let word_fullLevel=this._btn_upgrade.getChildByName(\"word_fullLevel\");\r\n            lb_cost.active=false;\r\n            word_fullLevel.active=true;\r\n        }\r\n    }\r\n\r\n\r\n    isMaxLevel(){\r\n        return GameCtr.ManufactureLevel==GameCtr.maxManufactureLevel;\r\n    }\r\n\r\n    doUpdate(){\r\n        if(this._btn_upgrade.getComponent(cc.Button).interactable){return}\r\n        this.showBtn();\r\n    }\r\n}\r\n"]}