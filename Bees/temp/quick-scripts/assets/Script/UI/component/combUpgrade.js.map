{"version":3,"sources":["combUpgrade.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\component","sourcesContent":["\r\nconst {ccclass, property} = cc._decorator;\r\nimport AudioManager from \"../../Common/AudioManager\";\r\nimport GameCtr from \"../../Controller/GameCtr\";\r\nimport Util from \"../../Common/Util\";\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n    _lb_des=null;\r\n    _btn_close=null;\r\n    _btn_upgrade=null;\r\n    _lb_cost=null;\r\n    _level=null;\r\n    _unlockNum=null;\r\n    _interval=0;\r\n\r\n    onLoad(){\r\n        this.initNode()\r\n    }\r\n\r\n    initNode(){\r\n        this._lb_des=this.node.getChildByName(\"lb_des\");\r\n        this._btn_close=this.node.getChildByName(\"btn_close\");\r\n        this.initBtnEvent(this._btn_close);\r\n    }\r\n\r\n    init(level,unlockNum){\r\n        this._level=level;\r\n        this._unlockNum=unlockNum;\r\n\r\n        this._lb_des.getComponent(cc.Label).string=this._unlockNum+1;\r\n        this.showCells();\r\n        this.showSpeed();\r\n        this.showhoneyProduction();\r\n        this.showUpgrade();\r\n        this.updateBtnState();\r\n        this.initBtnEvent(this._btn_upgrade);\r\n    }\r\n\r\n    showCells(){\r\n        let cells=this.node.getChildByName(\"cells\")\r\n        let lb_value=cells.getChildByName(\"lb_value\");\r\n        let lb_add=cells.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=\"\"+this._unlockNum;\r\n        lb_add.getComponent(cc.Label).string=\"+\"+1;\r\n    }\r\n\r\n    showSpeed(){\r\n        let speed=this.node.getChildByName(\"speed\")\r\n        let lb_value=speed.getChildByName(\"lb_value\");\r\n        let lb_add=speed.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=\"100%\";\r\n        lb_add.getComponent(cc.Label).string=\"+0%\";\r\n    }\r\n\r\n    showhoneyProduction(){\r\n        let honeyPorduction=this.node.getChildByName(\"honeyProduction\")\r\n        let lb_value=honeyPorduction.getChildByName(\"lb_value\");\r\n        let lb_add=honeyPorduction.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=\"\"+Util.formatNumber(GameCtr.combConfig[this._level-1].initialIncome+GameCtr.combConfig[this._level-1].incomeMatrix*(this._unlockNum-1));\r\n        lb_add.getComponent(cc.Label).string=\"+\"+Util.formatNumber(GameCtr.combConfig[this._level-1].incomeMatrix);\r\n    }\r\n\r\n    showUpgrade(){\r\n        let upgrade=this.node.getChildByName(\"upgrade\");\r\n        this._btn_upgrade=upgrade.getChildByName(\"btn_upgrade\");\r\n        this._lb_cost=this._btn_upgrade.getChildByName(\"lb_cost\");\r\n        this._lb_cost.getComponent(cc.Label).string=\"￥\"+Util.formatNumber(GameCtr.combConfig[this._level-1].levelUpCost+GameCtr.combConfig[this._level-1].upMatrix*(this._unlockNum));\r\n        \r\n    }\r\n\r\n    initBtnEvent(btn){\r\n        btn.on(cc.Node.EventType.TOUCH_END,(e)=>{\r\n           \r\n            if(e.target.getName()==\"btn_close\"){\r\n                this.node.destroy();\r\n                GameCtr.getInstance().getGame().setMaskVisit(false);\r\n                GameCtr.getInstance().getGame().clearCombUpGrade();\r\n                AudioManager.getInstance().playSound(\"audio/btnClose\");\r\n            }else if(e.target.getName()==\"btn_upgrade\"){\r\n                if(!this._btn_upgrade.getComponent(cc.Button).interactable){return}\r\n                AudioManager.getInstance().playSound(\"audio/btn_click\");\r\n                let comb=GameCtr.getInstance().getGame().getComb(this._level);\r\n                comb.getComponent(\"honeycomb\").upgrade();\r\n                this._unlockNum++;\r\n                this._lb_des.getComponent(cc.Label).string=this._unlockNum+1;\r\n                if(this._unlockNum==GameCtr.maxPerCombLevel){\r\n                    this._btn_upgrade.getComponent(cc.Button).interactable=false;\r\n                    this._lb_cost.getComponent(cc.Label).string=\"已满级\"\r\n                    return;\r\n                }\r\n                this.showCells();\r\n                this.showSpeed();\r\n                this.showhoneyProduction();\r\n                this.showUpgrade();\r\n                this.updateBtnState();\r\n            }\r\n        })\r\n    }\r\n\r\n    updateBtnState(){\r\n        if(GameCtr.money<GameCtr.combConfig[this._level-1].levelUpCost+GameCtr.combConfig[this._level-1].upMatrix*this._unlockNum){\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=false;\r\n        }else{\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=true;\r\n        }\r\n\r\n    }\r\n\r\n    doUpdate(dt){\r\n        if(this._btn_upgrade.getComponent(cc.Button).interactable || this._unlockNum>=GameCtr.maxPerCombLevel){return}\r\n        this._interval+=dt;\r\n        if(this._interval>=0.5){\r\n            this.updateBtnState();\r\n            this._interval=0;\r\n        }\r\n    }\r\n\r\n}\r\n"]}