{"version":3,"sources":["../../../../../../assets/Script/UI/component/assets/Script/UI/component/combUpgrade.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/Script/UI/component","sourcesContent":["\r\nconst {ccclass, property} = cc._decorator;\r\nimport AudioManager from \"../../Common/AudioManager\";\r\nimport GameCtr from \"../../Controller/GameCtr\";\r\nimport Util from \"../../Common/Util\";\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n    _lb_des=null;\r\n    _btn_close=null;\r\n    _btn_upgrade=null;\r\n    _lb_cost=null;\r\n    _level=null;\r\n    _unlockNum=null;\r\n\r\n    onLoad(){\r\n        this.initNode()\r\n    }\r\n\r\n    initNode(){\r\n        this._lb_des=this.node.getChildByName(\"lb_des\");\r\n        this._btn_close=this.node.getChildByName(\"btn_close\");\r\n        this.initBtnEvent(this._btn_close);\r\n    }\r\n\r\n    init(level,unlockNum){\r\n        this._level=level;\r\n        this._unlockNum=unlockNum;\r\n        this._lb_des.getComponent(cc.Label).string=this._unlockNum+1;\r\n        if(this._unlockNum>=GameCtr.maxPerCombLevel){\r\n            this._lb_des.getComponent(cc.Label).string=this._unlockNum;\r\n        }\r\n        \r\n        this.showCells();\r\n        this.showSpeed();\r\n        this.showhoneyProduction();\r\n        this.showUpgrade();\r\n        this.updateBtnState();\r\n        this.initBtnEvent(this._btn_upgrade);\r\n    }\r\n\r\n    showCells(){\r\n        let cells=this.node.getChildByName(\"cells\")\r\n        let lb_value=cells.getChildByName(\"lb_value\");\r\n        let lb_add=cells.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=\"\"+this._unlockNum;\r\n        lb_add.getComponent(cc.Label).string=\"+\"+1;\r\n    }\r\n\r\n    showSpeed(){\r\n        let speed=this.node.getChildByName(\"speed\")\r\n        let lb_value=speed.getChildByName(\"lb_value\");\r\n        let lb_add=speed.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=100+this._unlockNum+\"%\";\r\n        lb_add.getComponent(cc.Label).string=\"+\"+GameCtr.combConfig[this._level-1].speedMatrix*100+\"%\";\r\n    }\r\n\r\n    showhoneyProduction(){\r\n        let honeyPorduction=this.node.getChildByName(\"honeyProduction\")\r\n        let lb_value=honeyPorduction.getChildByName(\"lb_value\");\r\n        let lb_add=honeyPorduction.getChildByName(\"lb_add\");\r\n\r\n        lb_value.getComponent(cc.Label).string=\"\"+Util.formatNumber(GameCtr.combConfig[this._level-1].initialIncome+GameCtr.combConfig[this._level-1].incomeMatrix*(this._unlockNum-1));\r\n        lb_add.getComponent(cc.Label).string=\"+\"+Util.formatNumber(GameCtr.combConfig[this._level-1].incomeMatrix);\r\n    }\r\n\r\n    showUpgrade(){\r\n        let upgrade=this.node.getChildByName(\"upgrade\");\r\n        this._btn_upgrade=upgrade.getChildByName(\"btn_upgrade\");\r\n        this._lb_cost=this._btn_upgrade.getChildByName(\"lb_cost\");\r\n        this._lb_cost.getComponent(cc.Label).string=\"$\"+Util.formatNumber(GameCtr.combConfig[this._level-1].levelUpCost+\r\n            GameCtr.combConfig[this._level-1].upMatrix*(this._unlockNum-1));\r\n        \r\n    }\r\n\r\n    initBtnEvent(btn){\r\n        btn.on(cc.Node.EventType.TOUCH_END,(e)=>{\r\n           \r\n            if(e.target.getName()==\"btn_close\"){\r\n                this.node.destroy();\r\n                GameCtr.getInstance().getGame().setMaskVisit(false);\r\n                GameCtr.getInstance().getGame().clearCombUpGrade();\r\n                AudioManager.getInstance().playSound(\"audio/btnClose\");\r\n            }else if(e.target.getName()==\"btn_upgrade\"){\r\n                if(this._unlockNum<GameCtr.maxPerCombLevel&&GameCtr.money<GameCtr.combConfig[this._level-1].levelUpCost+GameCtr.combConfig[this._level-1].upMatrix*(this._unlockNum-1)){\r\n                    GameCtr.getInstance().getGame().showGoldNotEnough();\r\n                    return;\r\n                }\r\n\r\n                if(!this._btn_upgrade.getComponent(cc.Button).interactable){return;}\r\n                AudioManager.getInstance().playSound(\"audio/levelup\");\r\n                let comb=GameCtr.getInstance().getGame().getComb(this._level);\r\n                \r\n                comb.getComponent(\"honeycomb\").upgrade();\r\n                this._unlockNum++;\r\n                this._lb_des.getComponent(cc.Label).string=this._unlockNum+1;\r\n                if(this._unlockNum==GameCtr.maxPerCombLevel){\r\n                    this._btn_upgrade.getComponent(cc.Button).interactable=false;\r\n                    let lb_cost=this._btn_upgrade.getChildByName(\"lb_cost\");\r\n                    let word_fullLevel=this._btn_upgrade.getChildByName(\"word_levelFull\");\r\n                    lb_cost.active=false;\r\n                    word_fullLevel.active=true;\r\n\r\n                    return;\r\n                }\r\n                this.showCells();\r\n                this.showSpeed();\r\n                this.showhoneyProduction();\r\n                this.showUpgrade();\r\n                this.updateBtnState();\r\n\r\n            }\r\n        })\r\n    }\r\n\r\n    updateBtnState(){\r\n        if(GameCtr.money<GameCtr.combConfig[this._level-1].levelUpCost+GameCtr.combConfig[this._level-1].upMatrix*(this._unlockNum-1)){\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=false;\r\n        }else{\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=true;\r\n        }\r\n        if(this._unlockNum>=GameCtr.maxPerCombLevel){\r\n            this._btn_upgrade.getComponent(cc.Button).interactable=false;\r\n\r\n            let lb_cost=this._btn_upgrade.getChildByName(\"lb_cost\");\r\n            let word_fullLevel=this._btn_upgrade.getChildByName(\"word_levelFull\");\r\n            lb_cost.active=false;\r\n            word_fullLevel.active=true;\r\n        }\r\n    }\r\n\r\n    doUpdate(){\r\n        if(this._btn_upgrade.getComponent(cc.Button).interactable || this._unlockNum>=GameCtr.maxPerCombLevel){return}\r\n        this.updateBtnState();\r\n    }\r\n\r\n}\r\n"]}