{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\game/assets\\Script\\UI\\game\\level.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\game","sourcesContent":["\r\nconst {ccclass, property} = cc._decorator;\r\nimport AudioManager from \"../../Common/AudioManager\";\r\nimport GameCtr from \"../../Controller/GameCtr\";\r\nimport Util from \"../../Common/Util\";\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    levelUpgrade:cc.Prefab=null;\r\n\r\n    private lb_level=null;\r\n    private lb_money=null;\r\n    private lb_time=null;\r\n    private btn_upgrade=null;\r\n    private btn_rank=null;\r\n    // private headImg=null;\r\n    private icon_Arrow=null;\r\n    private progress=null;\r\n    private currentTime=null;\r\n\r\n    onLoad(){\r\n        GameCtr.getInstance().setLevel(this);\r\n        this.initNode();\r\n        this.updateTime();\r\n    }\r\n\r\n    initNode(){\r\n        this.lb_level=this.node.getChildByName(\"lb_level\");\r\n        this.lb_money=this.node.getChildByName(\"lb_money\");\r\n        this.lb_time=this.node.getChildByName(\"lb_time\");\r\n        this.btn_upgrade=this.node.getChildByName(\"btn_upgrade\");\r\n        this.btn_rank=this.node.getChildByName(\"btn_rank\");\r\n        this.icon_Arrow=this.node.getChildByName(\"icon_arrow\");\r\n        this.progress=this.node.getChildByName(\"progress\");\r\n        // this.headImg=this.node.getChildByName(\"headMask\").getChildByName(\"headImg\");\r\n        \r\n        this.icon_Arrow.active=false;\r\n        this.progress.getComponent(cc.ProgressBar).progress=0;\r\n        this.lb_money.getComponent(cc.Label).string=0;\r\n        \r\n        this.initBtnEvent(this.btn_upgrade);\r\n        this.initBtnEvent(this.btn_rank);\r\n        this.setLevel();\r\n        this.showBtnUpGrade();\r\n    }\r\n\r\n    initBtnEvent(btn){\r\n        btn.on(cc.Node.EventType.TOUCH_END,(e)=>{\r\n            if(e.target.getName()==\"btn_upgrade\"){\r\n               \r\n                if(cc.find(\"Canvas\").getChildByName(\"levelUpgrade\")){return;}\r\n                let levelUpgrade=cc.instantiate(this.levelUpgrade);\r\n                levelUpgrade.parent=cc.find(\"Canvas\");\r\n                levelUpgrade.y=-1218;\r\n                levelUpgrade.runAction(cc.moveBy(0.4,cc.p(0,1218)).easing(cc.easeElasticOut(3.0)));\r\n                GameCtr.getInstance().getGame().setMaskVisit(true);\r\n                AudioManager.getInstance().playSound(\"audio/btn_click\");\r\n            }else if(e.target.getName()==\"btn_rank\"){\r\n\r\n            }\r\n        })\r\n    }\r\n\r\n    upgrade(){\r\n        //GameCtr.money-=GameCtr.levelConfig[GameCtr.level-1].need;\r\n        GameCtr.money+=GameCtr.levelConfig[GameCtr.level-1].award;\r\n        GameCtr.levelMoney=0;\r\n        this.setMoney();\r\n        this.showBtnUpGrade();\r\n        GameCtr.level+=1;\r\n        this.setLevel();\r\n        GameCtr.getInstance().setPlayerLevel();\r\n        this.progress.getComponent(cc.ProgressBar).progress=0;\r\n    }\r\n\r\n    // loadHeadImg(imgUrl){\r\n    //     let spr=this.headImg.getComponent(cc.Sprite);\r\n    //     cc.loader.load({\r\n    //         url: imgUrl,\r\n    //         type: 'png'\r\n    //     }, (err, texture) => {\r\n    //         spr.spriteFrame = new cc.SpriteFrame(texture);\r\n    //     });\r\n    // }\r\n\r\n    setLevel(){\r\n        this.lb_level.getComponent(cc.Label).string=\"Lv\"+GameCtr.level;\r\n        this.hideArrow();\r\n        if(GameCtr.combConfig[GameCtr.comblevel].needLevel==GameCtr.level){\r\n            GameCtr.getInstance().getGame().unlockComb();\r\n        }\r\n    }\r\n\r\n    setMoney(){\r\n        this.lb_money.getComponent(cc.Label).string=Util.formatNumber(GameCtr.money);\r\n        this.showBtnUpGrade();\r\n    }\r\n\r\n    updateLevelProgress(){\r\n        console.log(\"log------------------GameCtr.levelMoney   need=:\",GameCtr.levelMoney,GameCtr.levelConfig[GameCtr.level-1].need)\r\n        this.progress.getComponent(cc.ProgressBar).progress=GameCtr.levelMoney/GameCtr.levelConfig[GameCtr.level-1].need;\r\n    }\r\n\r\n    showArrowAction(){\r\n        this.icon_Arrow.active=true;\r\n        this.icon_Arrow.runAction(cc.repeatForever(cc.sequence(\r\n            cc.scaleTo(0.15,1.1),\r\n            cc.callFunc(function(){\r\n                this.icon_Arrow.scale=1.0;\r\n            }.bind(this))\r\n        )))\r\n    }\r\n\r\n    hideArrow(){\r\n        this.icon_Arrow.active=false;\r\n        this.icon_Arrow.stopAllActions();\r\n    }\r\n\r\n    updateTime(){\r\n        this.currentTime = new Date(Date.now());\r\n        if(this.currentTime.getMinutes()<10){\r\n            this.lb_time.getComponent(cc.Label).string= this.currentTime.getHours()+\":0\"+this.currentTime.getMinutes();\r\n        }else{\r\n            this.lb_time.getComponent(cc.Label).string= this.currentTime.getHours()+\":\"+this.currentTime.getMinutes();\r\n        }\r\n        this.scheduleOnce(this.updateTime.bind(this),30)\r\n    }   \r\n\r\n    showBtnUpGrade(){\r\n        if(GameCtr.levelMoney>=GameCtr.levelConfig[GameCtr.level-1].need){\r\n            this.enabledBtn(true);\r\n        }else{\r\n            this.enabledBtn(false);\r\n        }\r\n    }\r\n\r\n    enabledBtn(isEffectable){\r\n        this.btn_upgrade.getComponent(cc.Button).interactable=isEffectable;\r\n    }\r\n    \r\n\r\n}\r\n"]}