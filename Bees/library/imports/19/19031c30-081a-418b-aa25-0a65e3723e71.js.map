{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\view/assets\\Script\\UI\\view\\PopupView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\UI\\view","sourcesContent":["/**\r\n * 基础弹出界面\r\n */\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PopupView extends cc.Component {\r\n\r\n    private _maskNode: cc.Node = null;//蒙层\r\n    contentNode: cc.Node;\r\n\r\n    private _showMask: boolean;//是否显示蒙层\r\n    private _maskOpacity: number = 0;//蒙层不透明度\r\n    private destroyCallback: Function;\r\n    private _closeOnTouchOutside: boolean;//是否点击外面关闭\r\n    private _closeOnKeyBack: boolean;//是否点击返回键关闭\r\n    private _showAction: cc.Action;\r\n    private _showActionTarget: cc.Node;\r\n    private _dismissAction: cc.Action;\r\n    private _dismissActionTarget: cc.Node\r\n    private _localZOrder: number = 0;\r\n\r\n    onLoad() {\r\n        cc.log(\"PopupView onLoad %s\", this.name);\r\n        this._maskNode = this.node.getChildByName(\"mask\");\r\n        if (this._maskNode) {\r\n            this._maskNode.active = this._showMask;\r\n            this._maskNode.opacity = this._maskOpacity;\r\n            this._maskNode.on(cc.Node.EventType.TOUCH_START, this.onTouchMask, this);\r\n            this._maskNode.on(cc.Node.EventType.TOUCH_END, this.onTouchMask, this);\r\n        }\r\n    }\r\n\r\n    onDestroy() {\r\n        cc.log(\"PopupView onDestroy %s\", this.name);\r\n        if (this._maskNode) {\r\n            this._maskNode.off(cc.Node.EventType.TOUCH_START, this.onTouchMask, this);\r\n            this._maskNode.off(cc.Node.EventType.TOUCH_END, this.onTouchMask, this);\r\n        }\r\n        if (this.destroyCallback) {\r\n            this.destroyCallback(this);\r\n        }\r\n    }\r\n\r\n    onTouchMask(event: cc.Event.EventTouch) {\r\n        event.stopPropagation();\r\n        if (event.type == cc.Node.EventType.TOUCH_END\r\n            && this.closeOnTouchOutside\r\n            && this.contentNode\r\n            && !cc.rectContainsPoint(this.contentNode.getBoundingBoxToWorld(), event.getLocation())) {\r\n            this.dismiss();\r\n        }\r\n    }\r\n\r\n    show(parent: cc.Node) {\r\n        if (!cc.isValid(this) || !cc.isValid(parent)) {\r\n            return;\r\n        }\r\n        this.node.parent = parent;\r\n        this.node.setLocalZOrder(this.localZOrder || 0);\r\n        if (cc.isValid(this._showActionTarget) && cc.isValid(this._showAction)) {\r\n            this._showActionTarget.stopAllActions();\r\n            this._showActionTarget.runAction(this._showAction);\r\n        }\r\n    }\r\n\r\n    dismiss() {\r\n        if (!cc.isValid(this.node)) {\r\n            return;\r\n        }\r\n        if (cc.isValid(this._dismissActionTarget) && cc.isValid(this._dismissAction)) {\r\n            this._dismissActionTarget.stopAllActions();\r\n            this._dismissActionTarget.runAction(this._dismissAction);\r\n        } else {\r\n            this.doDismiss();\r\n        }\r\n    }\r\n\r\n    private doDismiss() {\r\n        this.node.destroy();\r\n    }\r\n\r\n    setMask(showMask: boolean, maskOpacity) {\r\n        this._showMask = showMask;\r\n        this._maskOpacity = maskOpacity;\r\n    }\r\n\r\n    setShowAction(action: cc.FiniteTimeAction, target: cc.Node) {\r\n        if (cc.isValid(target) && cc.isValid(action)) {\r\n            this._showAction = action;\r\n            this._showActionTarget = target;\r\n        }\r\n    }\r\n\r\n    setDismissAction(action: cc.FiniteTimeAction, target: cc.Node) {\r\n        if (cc.isValid(target) && cc.isValid(action)) {\r\n            this._dismissAction = cc.sequence(action, cc.callFunc(() => { this.doDismiss(); }));\r\n            this._dismissActionTarget = target;\r\n        }\r\n    }\r\n\r\n    setOnDestroyCallback(callback: Function) {\r\n        this.destroyCallback = callback;\r\n    }\r\n\r\n    set closeOnTouchOutside(value: boolean) {\r\n        this._closeOnTouchOutside = value;\r\n    }\r\n\r\n    get closeOnTouchOutside(): boolean {\r\n        return this._closeOnTouchOutside;\r\n    }\r\n\r\n    set closeOnKeyBack(value: boolean) {\r\n        this._closeOnKeyBack = value;\r\n    }\r\n\r\n    get closeOnKeyBack(): boolean {\r\n        return this._closeOnKeyBack;\r\n    }\r\n\r\n    set localZOrder(localZOrder: number) {\r\n        this._localZOrder = localZOrder;\r\n    }\r\n\r\n    get localZOrder() {\r\n        return this._localZOrder;\r\n    }\r\n}\r\n"]}