{"version":3,"sources":["../../../../../../assets/Script/UI/game/assets/Script/UI/game/Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/Script/UI/game","sourcesContent":["/**\r\n * 游戏界面\r\n * 游戏逻辑自己实现\r\n */\r\nimport GameCtr from \"../../Controller/GameCtr\";\r\n// import WXCtr from \"../../Controller/WXCtr\";\r\n// import ViewManager from \"../../Common/ViewManager\";\r\n// import HttpCtr from \"../../Controller/HttpCtr\";\r\n// import UserManager from \"../../Common/UserManager\";\r\nimport Util from \"../../Common/Util\";\r\nimport AudioManager from \"../../Common/AudioManager\";\r\nimport { MemoryDetector } from \"../../Common/MemoryDetector\";\r\n\r\n// import AudioManager from \"../../Common/AudioManager\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n@ccclass\r\nexport default class Game extends cc.Component {\r\n\r\n    _honeycombContent=null;\r\n    _pipelineNode=null;\r\n    _glassPipeline=null;\r\n    _mask=null;\r\n    _combUpgrade=null;\r\n    _manufactureUpgrade=null;\r\n\r\n    _combList=[];\r\n\r\n    @property(cc.Prefab)\r\n    test:cc.Prefab=null;\r\n\r\n    @property(cc.Prefab)\r\n    test1:cc.Prefab=null;\r\n\r\n    @property(cc.Prefab)\r\n    honeyComb:cc.Prefab=null;\r\n\r\n    onLoad(){\r\n        GameCtr.getInstance().setGame(this);\r\n        GameCtr.getInstance().initEventTarget();\r\n        this.initData();\r\n        this.initNode();\r\n        AudioManager.getInstance().playMusic(\"audio/bgMusic\");\r\n        //MemoryDetector.showMemoryStatus();\r\n    }\r\n\r\n    initData(){\r\n        //window.localStorage.clear();\r\n        if(window.localStorage.getItem(\"level\")){\r\n            GameCtr.level=Number(window.localStorage.getItem(\"level\")); \r\n        }else{\r\n            GameCtr.level=1;\r\n            GameCtr.getInstance().setPlayerLevel();\r\n        }\r\n\r\n        if(window.localStorage.getItem(\"ManufactureLevel\")){\r\n            GameCtr.ManufactureLevel=Number(window.localStorage.getItem(\"ManufactureLevel\")); \r\n        }else{\r\n            GameCtr.ManufactureLevel=1;\r\n            GameCtr.getInstance().setManufactureLevel();\r\n        }\r\n\r\n        if(window.localStorage.getItem(\"comblevel\")){\r\n            GameCtr.comblevel=Number(window.localStorage.getItem(\"comblevel\")); \r\n        }else{\r\n            GameCtr.comblevel=1;\r\n            GameCtr.getInstance().setCombLevel();\r\n        }\r\n\r\n        if(window.localStorage.getItem(\"combsUnlock\")){\r\n            GameCtr.combsUnlock=JSON.parse(window.localStorage.getItem(\"combsUnlock\")); \r\n        }else{\r\n            GameCtr.combsUnlock=[];\r\n            GameCtr.combsUnlock.push(1);\r\n            GameCtr.getInstance().setCombsUnlock();\r\n\r\n            let combsUnlock=GameCtr.getInstance().getCombsUnlock();\r\n        }\r\n    }\r\n\r\n    initNode(){\r\n        this._mask=this.node.getChildByName(\"mask\");\r\n        this._honeycombContent=this.node.getChildByName(\"honeycombNode\").getChildByName(\"scrollView\").getChildByName(\"view\").getChildByName(\"content\");\r\n        this._pipelineNode=this._honeycombContent.getChildByName(\"pipelineNode\");\r\n        this._glassPipeline=this._honeycombContent.getChildByName(\"glassPipeline\")\r\n        this._glassPipeline.setLocalZOrder(0)\r\n        this._pipelineNode.setLocalZOrder(10);\r\n        this.initComb();\r\n    }\r\n\r\n    initComb(){\r\n        let combsUnlock=GameCtr.getInstance().getCombsUnlock();\r\n        for(let level=0;level<GameCtr.comblevel+5;level++){\r\n            let honeyComb=cc.instantiate(this.honeyComb);\r\n            let unlock=combsUnlock[level]?combsUnlock[level]:0;\r\n            honeyComb.tag=GameCtr.comblevel+level;\r\n            honeyComb.parent=this._honeycombContent;\r\n            honeyComb.setLocalZOrder(2);\r\n            honeyComb.x=60;\r\n            honeyComb.y=-200-408*level;\r\n            honeyComb.getComponent(\"honeycomb\").setLevel(level+1,unlock);\r\n            honeyComb.getComponent(\"honeycomb\").initBtn();\r\n\r\n            this._combList.push(honeyComb);\r\n        }\r\n    }\r\n\r\n    unlockComb(){\r\n        let comb=this._honeycombContent.getChildByTag(GameCtr.comblevel+1);\r\n        comb.getComponent(\"honeycomb\").setCanUnlock(true);\r\n        comb.getComponent(\"honeycomb\").showUnlockBtn(true);\r\n        GameCtr.comblevel++;\r\n    }\r\n\r\n    getComb(combLevel){\r\n        return this._honeycombContent.getChildByTag(combLevel);\r\n    }\r\n\r\n    setMaskVisit(isVisit){\r\n        this._mask.active=isVisit;\r\n    }\r\n\r\n\r\n    setCombUpgrade(node){\r\n        this._combUpgrade=node;\r\n    }\r\n\r\n    setManufactureUpgrade(node){\r\n        this._manufactureUpgrade=node;\r\n    }\r\n\r\n    clearCombUpGrade(){\r\n        this._combUpgrade=null;\r\n    }\r\n\r\n    clearManufactureUpgrade(){\r\n        this._manufactureUpgrade=null;\r\n    }\r\n\r\n    update(dt){\r\n        for(let i=0;i<this._combList.length;i++){\r\n            this._combList[i].getComponent(\"honeycomb\").doWork(dt);\r\n        }\r\n\r\n\r\n        if(this._combUpgrade){\r\n            this._combUpgrade.getComponent(\"combUpgrade\").doUpdate(dt)\r\n        }\r\n\r\n        if(this._manufactureUpgrade){\r\n            this._manufactureUpgrade.getComponent(\"manufactureUpgrade\").doUpdate(dt);\r\n        }\r\n    }\r\n\r\n}\r\n"]}