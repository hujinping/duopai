{"version":3,"sources":["../../../../../../assets/Script/UI/component/assets/Script/UI/component/pfTurntable.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/Script/UI/component","sourcesContent":["\n//import PopupView from \"../view/PopupView\";\n//import ViewManager from \"../../Common/ViewManager\";\nimport GameCtr from \"../../Controller/GameCtr\";\nimport GameData from \"../../Common/GameData\";\nimport WXCtr from \"../../Controller/WXCtr\";\nimport AudioManager from \"../../Common/AudioManager\";\n\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class pfTurntable extends cc.Component {\n    @property(cc.Node)\n    wheelSp:cc.Node=null\n\n    @property(cc.Node)\n    btnSp:cc.Node=null\n    @property(cc.Button)\n    btn:cc.Button=null\n    @property(cc.Label)\n    labelTips:cc.Label=null\n\n    @property(cc.Prefab)\n    award:cc.Prefab=null\n\n    private data = {type:5}\n    private active = true;\n    private isTurning=false;\n\n    //根据数据初始化\n    myInit(again){\n        // if(again) return;//如果是“再来一次”，则无需判断时间\n\n        // let hours = cc.sys.localStorage.getItem(\"hours\");\n        // let nowHours =new Date().getHours(); //获取当前小时数(0-23)\n        // if(hours==nowHours){\n        //     let num = 60 -new Date().getMinutes();\n        //     this.labelTips.string = \"距离下一次抽奖还有\"+num+\"分钟\";\n        //     this.active = false;\n        //     //按钮禁用\n        //     this.btn.interactable = false;\n        // }else cc.sys.localStorage.setItem(\"hours\",nowHours);\n    }\n    setData(data){\n        this.data = data;\n    }\n    // update (dt) {},\n    callBack_btn(){\n        if(GameData.pfTurntable < 1){\n            WXCtr.share({pfTurnable:true})\n        }else{\n            GameData.pfTurntable--;\n            //按钮禁用\n            this.btn.node.active = false;\n            this.btnSp.active = true;\n            //请求数据\n            // let func = (data)=>{\n            //     this.data = data.data;\n            //     this.requestResults()\n            // }\n            //GameCtr.turntableInfo(func);\n\n            this.data = {type:Math.floor(Math.random()*7)};\n            this.requestResults();\n            GameCtr.getInstance().getGame().disableBtnPfturnable();\n            GameCtr.getInstance().getGame().startPfTurntableTime();\n        }\n        \n    }\n    showResult(type){\n        let awardData=GameCtr.pfTurnTableConfig[type];\n        if(this.node.getChildByName(\"award\")){return;}\n        let award=cc.instantiate(this.award);\n        award.parent=this.node;\n        award.getComponent(\"award\").showAward(awardData)\n        this.isTurning=false;\n    }\n    requestResults(){\n        this.isTurning=true;\n        let nowHours =new Date().getHours(); //获取当前小时数(0-23)\n        cc.sys.localStorage.setItem(\"hours\",nowHours);\n\n        //基础数据\n        let elickTimes = 10;\n        let rounds = 10;\n\n        //获取结果类型，得出相对偏转角度\n        //0~45，~90,~135,~180,~225,~270,~315,~360\n        let type = null;//Math.floor(Math.random()*8);//客户端随机，测试用\n        type = this.data.type;\n        let awardAngle = (Math.random()*35+5) +45*type;\n        console.log(\"&&&&^*\",this.data,awardAngle);\n\n        //动作及执行\n        var rotateBy = cc.rotateBy(elickTimes, awardAngle + 360*rounds).easing(cc.easeCubicActionOut()); \n        let finish = cc.callFunc(()=>{\n            this.showResult(type);\n        });\n        let seq =cc.sequence(rotateBy,finish);\n        var actionstepA = this.wheelSp.runAction(seq);\n        //播放音效\n        AudioManager.getInstance().playSound(\"audio/lottery_draw\", false);\n    }\n    callBack_test(){\n        this.btn.interactable = true;\n    }\n\n    close() {\n        if(this.isTurning){return}\n\n        AudioManager.getInstance().playSound(\"audio/btnClose\");\n        this.node.destroy();\n    }\n}\n"]}